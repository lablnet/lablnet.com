---
// @ts-ignore
import { getCollection } from 'astro:content';
import { meta } from '../../utils/const';
import { df, compareByDate } from '../../utils/index.ts';

const certificates = await getCollection('certificates');
certificates.sort(compareByDate);
---

<main>
	<section class="py-2" id="certificates">
		<div class="mb-8">
			<h3 class="text-3xl font-bold mb-4 bg-gradient-to-r from-muf-500 via-muf-700 to-muf-cyan-500 bg-clip-text text-transparent flex items-center">
				<i class="fa-solid fa-certificate text-muf-500 mr-3"></i>
				{ meta.certificate.title }
			</h3>
			<p class="text-gray-700 dark:text-gray-300 text-lg leading-relaxed">
				{ meta.certificate.description }
			</p>
		</div>
		
        <div class="space-y-4">
            {certificates.map((certificate:any, index: number) => (
                <div class="glass-card overflow-hidden animate-slide-up" style={`animation-delay: ${index * 0.1}s;`}>
                    <button
                        data-id={index}
                        class="accordion-button flex justify-between items-center w-full p-6 text-left hover:bg-white/10 dark:hover:bg-white/5 transition-all duration-300 group"
                    >
                        <div class="flex items-center gap-4">
							<div class="w-3 h-3 rounded-full bg-gradient-to-r from-muf-400 to-muf-cyan-400"></div>
                            <div>
                                <h4 class="font-bold text-gray-800 dark:text-gray-200 text-lg group-hover:text-muf-600 dark:group-hover:text-muf-400 transition-colors duration-300">
                                    {certificate.data.title}
                                </h4>
                                <p class="text-gray-600 dark:text-gray-400 text-sm">
                                    <i class="fa-solid fa-building mr-2 text-muf-500"></i>
                                    {certificate.data.institute} â€¢ {df.format(certificate.data.completed)}
                                </p>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-trophy text-muf-500 text-xl"></i>
                            <i class="fa-solid fa-chevron-down text-gray-400 group-hover:text-muf-500 transition-all duration-300 transform group-data-[expanded]:rotate-180"></i>
                        </div>
                    </button>
                    
                    <div data-id={index} class="accordion-content overflow-hidden transition-all duration-500 max-h-0">
                        <div class="p-6 pt-0 border-t border-white/10">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div class="space-y-4">
                                    <div class="flex items-center gap-3">
                                        <i class="fa-solid fa-calendar text-muf-500"></i>
                                        <span class="text-gray-700 dark:text-gray-300">
                                            Completed: {df.format(certificate.data.completed)}
                                        </span>
                                    </div>
                                    <a 
                                        href={certificate.data.link} 
                                        target="_blank" 
                                        class="glass-button inline-flex items-center gap-2 px-4 py-2 rounded-xl text-muf-600 dark:text-muf-400 hover:text-muf-700 dark:hover:text-muf-300 font-semibold transition-all duration-300 hover:scale-105"
                                    >
                                        <i class="fa-solid fa-external-link"></i>
                                        View Certificate
                                    </a>
                                </div>
                                <div class="glass-card p-4">
                                    <img 
                                        src={certificate.data.picture} 
                                        alt={certificate.data.title}
                                        class="w-full h-auto rounded-lg shadow-lg hover:scale-105 transition-transform duration-300" 
                                    />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    </section>
</main>

<script lang="js">
document.addEventListener('DOMContentLoaded', function() {
    let buttons = document.querySelectorAll('.accordion-button');
    for (let i = 0; i < buttons.length; i++) {
        buttons[i].addEventListener('click', function () {
            let content = document.querySelectorAll('.accordion-content');
            let id = this.getAttribute('data-id');
            let targetContent = content[id];
            let chevron = this.querySelector('.fa-chevron-down');
            
            if (targetContent.style.maxHeight && targetContent.style.maxHeight !== '0px') {
                targetContent.style.maxHeight = '0px';
                chevron.style.transform = 'rotate(0deg)';
            } else {
                targetContent.style.maxHeight = targetContent.scrollHeight + 'px';
                chevron.style.transform = 'rotate(180deg)';
            }
        });
    }
});
</script>

